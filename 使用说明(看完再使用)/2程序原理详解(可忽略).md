### 开发环境：

​	Pycharm2022.1

​	python 3.9.1

​	openpyxl 3.0.10 (python处理Excel的库)

​	pip 21.3.1

​	pyinstaller 5.3 (python打包成exe的库)

​	os(python读入文件的库)

​	tkinter(pythonGUI的库(图形界面))

### 源文件

​	main.py

### 程序具体原理

#### 方法/函数部分：

def get_col(col_num)

​	把列号(数字)转化为符号(str)，因为在openpyxl中操作Excel单元格只能是以['AA12']  ['B25']等的形式，所以经常要把列号转为为字符型的(A-Z,AA-AZ等等)

def searcher1()

​	循环范围(第一行到最后一行，第一列到最后一列)

​	搜索学分所在的行和列，返回行列的信息

def searcher2()

​	循环范围(学分所在行，学分所在列+1到最后一列)

​	搜索有学分的课的列的最大值(因为需要确定有成绩的列的范围),同时把字符型的学分转换为数值型

​	循环：

​		判断是否为空值 是则返回空值所在列-1

​		若不是空值

​			如果是数值型(int)

​				则跳过

​			否则

​				测量字符串的长度(实际上Excel单元格内存的值为列表,例如98.0存为['9','8','.','0',' ',' '])

​					如果长度大于等于3，则把前三位转为浮点型

​					如果长度等于2，则此项为字符0，把第一位转为浮点型

def trans()

循环范围(学分所在行+2到最后一列，学分所在列+1到有成绩的最后一列)

​	将字符型的值转换为数值型，因为字符型的值不能参与计算	

​	循环：

​		如果是‘- ’

​			则跳过

​		如果是数值型(int)

​			则跳过

​		否则

​				测量字符串的长度(实际上Excel单元格内存的值为列表,例如98.0存为['9','8','.','0',' ',' '])

​					如果长度大于等于3，则把前三位转为浮点型

​					如果长度等于2，则此项为字符0，把第一位转为浮点型

def compute()

​	循环范围(学分所在行+2到最后一列，学分所在列+1到有成绩的最后一列)

​	循环：

​		如果是‘- ’就跳过，不参与计算

​		否则：计算成绩×学分的值，并相加，计算学分和

​					(成绩×学分的和)/学分和，写入到最后一列的下一列

#### 主函数部分：

​	循环读入dist文件夹中的文件：

​		处理一个文件：

​			调用max，min函数获取行列的最大值

​			逐行逐列寻找到"学分"，并返回学分的行和列

​			找到最后一个有"学分"的科目，返回列值

​			把字符型(左上角有绿色角标)的成绩转换为数值型

​			计算加权成绩并在max_column+1写入(最后一列的下一列)

​		保存修改后的Excel文件

​	继续循环读入

全部处理完成，在屏幕上输出运行完成字样

### 参考资料&下载地址

Python编程：从入门到实践

Python编程快速上手 让繁琐工作自动化 第2版

[简单用法 — openpyxl 3.0.7 文档 (openpyxl-chinese-docs.readthedocs.io)](https://openpyxl-chinese-docs.readthedocs.io/zh_CN/latest/usage.html)

[Python GUI 编程(Tkinter) | 菜鸟教程 (runoob.com)](https://www.runoob.com/python/python-gui-tkinter.html)

[黑马程序员Python教程 哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1ex411x7Em?p=100&vd_source=e4e34669d298b91550342f9580ea1528)